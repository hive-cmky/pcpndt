<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>PC-PNDT Application Search</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .highlight {
            background-color: #fff3cd;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="container mt-4">
    <div class="card">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0">PC-PNDT Application Search</h4>
        </div>
        <div class="card-body">
            <form th:action="@{/pcpndt/search}" method="get" class="mb-4">
                <div class="row">
                    <div class="col-md-10">
                        <input type="text" name="applRefNo" class="form-control form-control-lg"
                               placeholder="Enter application reference number (e.g., PCPNDT/2021/00202, PCPNDT/2021/00585)"
                               th:value="${searchTerm}">
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-primary btn-lg w-100">Search</button>
                    </div>
                </div>
                <small class="form-text text-muted">
                    Examples: PCPNDT/2021/00202, PCPNDT/2021/00585, PCPNDT/2022/00028
                </small>
            </form>

            <div th:if="${resultCount != null}" class="mb-3">
                <div class="alert alert-info">
                    <strong th:text="'Found ' + ${resultCount} + ' application(s)'"></strong>
                    <span th:if="${searchTerm}" th:text="' for: ' + ${searchTerm}"></span>
                </div>
            </div>

            <div th:if="${applications != null && !applications.empty}">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-dark">
                        <tr>
                            <th>Reference No</th>
                            <th>Applicant Name</th>
                            <th>Centre Name</th>
                            <th>Type</th>
                            <th>Submission Date</th>
                            <th>Location</th>
                            <th>Actions</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="app : ${applications}">
                            <td>
                                <span th:text="${app.applRefNo}" class="text-primary fw-bold"></span>
                            </td>
                            <td th:text="${app.applicantName}"></td>
                            <td th:text="${app.nameOfCentre}"></td>
                            <td>
                                        <span th:text="${app.applicationType}"
                                              th:class="${app.applicationType == 'Registered (Form B Issued )'} ? 'badge bg-success' :
                                                         ${app.applicationType == 'Renewal'} ? 'badge bg-warning' :
                                                         ${app.applicationType == 'Applied (From B to be Issued)'} ? 'badge bg-info' : 'badge bg-secondary'">
                                        </span>
                            </td>
                            <td th:text="${app.submissionDate}"></td>
                            <td th:text="${app.submissionLocation}"></td>
                            <td>
                                <a th:href="@{/pcpndt/application/{refNo}(refNo=${app.applRefNo})}"
                                   class="btn btn-info btn-sm">View Details</a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div th:if="${applications != null && applications.empty}" class="alert alert-warning text-center">
                <h5>No applications found</h5>
                <p>No PC-PNDT applications found matching your search criteria.</p>
                <a href="/pcpndt/all" class="btn btn-primary">View All Applications</a>
            </div>

            <div class="text-center mt-4">
                <a href="/pcpndt/all" class="btn btn-secondary me-2">View All Applications</a>
                <a href="/pcpndt/search" class="btn btn-outline-primary">New Search</a>
            </div>
        </div>
    </div>
</div>
</body>
</html>